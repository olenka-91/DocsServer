# üìÑ DocsServer - API –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ Go —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π —Ñ–∞–π–ª–æ–≤, JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.

##  –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

-  **JWT –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø —Å access/refresh —Ç–æ–∫–µ–Ω–∞–º–∏
-  **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤** - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ –¥–∏—Å–∫–µ –∏ –≤ –ø–∞–º—è—Ç–∏
-  **–£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
-  **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
-  **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ PostgreSQL
-  **RESTful API** - –ß–∏—Å—Ç—ã–π –∏ —Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API
-  **Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
```go
// –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
–ö–µ—à –≤ –ø–∞–º—è—Ç–∏ (100MB –º–∞–∫—Å) ‚Üí –î–∏—Å–∫–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ä–∞–∑–º–µ—Ä–µ**: –§–∞–π–ª—ã –¥–æ 2MB –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: 5-–º–∏–Ω—É—Ç–Ω–æ–µ expiration –∫–µ—à–∞
- **LRU –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —á—Ç–µ–Ω–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Go 1.21+
- PostgreSQL 12+

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
```bash
git clone https://github.com/olenka-91/DocsServer.git
cd DocsServer
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```bash
go mod download
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
```bash
migrate -path migrations -database "postgres://docsserver:qwerty@localhost:5436/docsserver?sslmode=disable" up 
```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**
```bash
go run cmd/app/main.go
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å Docker

```bash
docker-compose up -d
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–ø—É–±–ª–∏—á–Ω—ã–µ)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|-----------|
| `POST` | `/api/auth` | –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (signIn) |
| `POST` | `/api/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (signUp) |
| `POST` | `/api/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ (refreshToken) |

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∑–∞—â–∏—â–µ–Ω–Ω—ã–µ)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|-----------|
| `POST` | `/api/logout` | –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (logout) |

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∑–∞—â–∏—â–µ–Ω–Ω—ã–µ)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|-----------|
| `GET` | `/api/docs` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| `HEAD` | `/api/docs` | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–ø–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| `GET` | `/api/docs/:id` | –ü–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ ID |
| `HEAD` | `/api/docs/:id` | –ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ ID |
| `POST` | `/api/docs` | –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç |
| `DELETE` | `/api/docs/:id` | –£–¥–∞–ª–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ ID |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
curl -L -X POST 'localhost:8000/api/register/' \
-H 'Content-Type: application/json' \
-d '{
    "name": "OlgaDvornikova7",
    "password": "Uprising123_"
}'
```

**–í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
curl -L -X POST 'localhost:8000/api/auth/' \
-H 'Content-Type: application/json' \
-d '{
    "name": "OlgaDvornikova7",
    "password": "Uprising123_"
}'
```

**–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```bash
curl -L -X POST 'localhost:8000/api/docs' \
 -H "Authorization: Bearer <–≤–∞—à_jwt_—Ç–æ–∫–µ–Ω>" \
 -F 'meta=" {
      \"name\": \"file.jpg\",
      \"file\": true,
      \"public\": true,      
      \"mime\": \"image/jpg\",
      \"grant\": [\"FirstUser3\", \"OlgaDvornikova7\"]
    }"' \
-F 'file=@"/C:/Users/–û–ª—å–≥–∞/Desktop/og_og.jpg"'
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:**
```bash
curl -L -X GET 'localhost:8000/api/docs/?key=filename&value=photo&limit=10' \
  -H "Authorization: Bearer <–≤–∞—à_jwt_—Ç–æ–∫–µ–Ω>"
```

**–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```bash
curl -L -X GET 'localhost:8000/api/docs/7ea0a0b8-c652-41a4-86de-678a0e214c8c' \
-H 'Authorization:  Bearer <–≤–∞—à_jwt_—Ç–æ–∫–µ–Ω>'
```

**–£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```bash
curl -L -X DELETE 'localhost:8000/api/docs/7ea0a0b8-c652-41a4-86de-678a0e214c8c' \
  -H "Authorization: Bearer <–≤–∞—à_jwt_—Ç–æ–∫–µ–Ω>"
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –°–µ—Ä–≤–µ—Ä
SERVER_PORT=8080
SERVER_HOST=localhost

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=password
DB_NAME=docsserver

# JWT
JWT_SECRET=your-secret-key
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=168h

# –•—Ä–∞–Ω–∏–ª–∏—â–µ
STORAGE_PATH=./storage
MAX_FILE_SIZE=10485760  # 10MB
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–µ—à–∞

```go
const (
    cacheTTL             = 5 * time.Minute
    maxMemoryCacheSize   = 100 * 1024 * 1024  // 100MB
    maxMemoryCachedFiles = 100
    maxFileCacheSize     = 2 * 1024 * 1024    // 2MB –Ω–∞ —Ñ–∞–π–ª
)
```

## üèõÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
DocsServer/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îú‚îÄ‚îÄ app/          # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ  
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ handler/         # HTTP –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
      ‚îî‚îÄ‚îÄ middleware/    # HTTP middleware
‚îÇ   ‚îú‚îÄ‚îÄ entity/          # –°—É—â–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ utils/           # –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ repository/      # –£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îú‚îÄ‚îÄ service/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ storage/         # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îú‚îÄ‚îÄ httpserver/      # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞
‚îî‚îÄ‚îÄ migrate/             # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: [Gin](https://github.com/gin-gonic/gin)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: [PostgreSQL](https://www.postgresql.org/) 
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: [JWT](https://github.com/golang-jwt/jwt)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: [Logrus](https://github.com/sirupsen/logrus)
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: [Viper](https://github.com/spf13/viper) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  
## üë• –ê–≤—Ç–æ—Ä—ã

- **Olenka-91** - –ù–∞—á–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ - [GitHub](https://github.com/olenka-91)

---

**‚≠ê –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é, –µ—Å–ª–∏ –æ–Ω –≤–∞–º –ø–æ–ª–µ–∑–µ–Ω!**
